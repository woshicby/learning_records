# 第二章 同余

## 2.1 同余的概念和基本性质

同余：给定3个整数$a,b,m$，如果$m\mid (a-b)$，则称$a$模$m$同余于$b$或$a,b$模$m$同余，记作$a\equiv b(mod\ m)$。若$m\nmid(a-b)$，则称$a,b$模$m$不同余。

由于$m\mid (a-b)\iff(-m)\mid(a-b)$所以总假定m是个正整数。

同余的等价定理①：$a\equiv b(mod\ m)$当且仅当存在整数k，使得$a=km+b$
证明：
$$
正向：&a\equiv b(mod\ m)\\
\iff&m\mid (a-b)\\
可设&a-b=km\\
则&a=km+b\\
反之：&a=km+b\\
\iff&a-b=km\\
\therefore&a\equiv b(mod\ m)
$$
同余的等价定理②：设$a=k_1m+r_1,b=k_2m+r_2,0\le r_1\lt m,0\le r_2\lt m$，则$a\equiv b(mod\ m)$当且仅当$r_1=r_2$。
证明：
$$
正向：&a-b=(k_1-k_2)m+(r_1-r_2),a\equiv b(mod\ m)\\
\Rightarrow&m\mid(a-b)\\
\therefore&m\mid(r_1-r_2)\\
又&0\le r_1\lt m,0\le r_2\lt m\\
\therefore&r_1-r_2=0\\
\iff&r_1=r_2\\
反之：&r_1=r_2\\
\Rightarrow&a-b=(k_1-k_2)m\\
\therefore&m\mid(a-b)\\
\therefore&a\equiv b(mod\ m)
$$
例子：某月1日周二，则25日周几？$\because25\equiv4(mod\ 7)$，4日周五，所以25日周五。

同余的性质①：
自反性：$a\equiv a(mod\ m)$
对称性：$a\equiv b(mod\ m)\iff b\equiv a(mod\ m)$
传递性：若$a\equiv b(mod\ m),b\equiv c(mod\ m)$，则$a\equiv c(mod\ m)$。

设$a,b,d,a_1,a_2,b_1.b_2,m$为正整数，则：
同余的性质②加法：若$a_1\equiv a_2(mod\ m),b_1\equiv b_2(mod\ m)$，则$a_1+b_1\equiv a_2+b_2(mod\ m)$
证明：
$$
&a_1\equiv a_2(mod\ m),b_1\equiv b_2(mod\ m)\\
\Rightarrow&m\mid a_1-a_2,m\mid b_1-b_2\\
\Rightarrow&m\mid(a_1-a_2)+(b_1-b_2)\\
\Rightarrow&a_1+b_1\equiv a_2+b_2(mod\ m)
$$
同余的性质③减法：若$a_1\equiv a_2(mod\ m),b_1\equiv b_2(mod\ m)$，则$a_1-b_1\equiv a_2-b_2(mod\ m)$
证明：
$$
&a_1\equiv a_2(mod\ m),b_1\equiv b_2(mod\ m)\\
\Rightarrow&m\mid a_1-a_2,m\mid b_1-b_2\\
\Rightarrow&m\mid(a_1-a_2)-(b_1-b_2)\\
\Rightarrow&a_1-b_1\equiv a_2-b_2(mod\ m)
$$
同余的性质④乘法：若$a_1\equiv a_2(mod\ m),b_1\equiv b_2(mod\ m)$，则$a_1b_1\equiv a_2b_2(mod\ m)$
证明：
$$
&a_1\equiv a_2(mod\ m),b_1\equiv b_2(mod\ m)\\
\Rightarrow&有a_1=k_1m+a_2,b_1=k_2m+b_2\\
\Rightarrow&a_1b_1=(k_1k_2m+k_1b_2+k_2a_2)m+a_2b_2\\
\Rightarrow&a_1b_1\equiv a_2b_2(mod\ m)
$$
Ps.除法运算不再完全成立，如$21\equiv 15(mod\ 6),7\not\equiv 5(mod\ 6)$
同余的性质⑤除法：若$ad\equiv bd(mod\ m),gcd(d,m)=1$，则$a\equiv b(mod\ m)$
证明：
$$
&ad\equiv bd(mod\ m)\\
\Rightarrow&m\mid ad-bd=m\mid(a-b)d\\
又&gcd(d,m)=1\\
\therefore&m\mid a-b\\
\therefore&a\equiv b(mod\ m)
$$
同余的性质⑥公因数提取：若$a\equiv b(mod\ m)$，d是$a,b,m$的任意公因数，则$\frac{a}{d}\equiv \frac{b}{d}(mod\ \frac{m}{d})$
证明：
$$
&a\equiv b(mod\ m)\\
\Rightarrow&m\mid a-b=m\mid(a-b)d\\
\therefore&\frac{m}{d}\mid \frac{a}{d}-\frac{b}{d}\\
\therefore&\frac{a}{d}\equiv \frac{b}{d}(mod\ \frac{m}{d})
$$
同余的性质⑦：若$a\equiv b(mod\ m),d\mid m,d\gt0$，则$a\equiv b(mod\ d)$
证明：
$$
&a\equiv b(mod\ m)\\
\iff&m\mid a-b\\
又&d\mid m\\
\therefore&d\mid a-b\\
\iff&a\equiv b(mod\ d)
$$
以上各定理的例子：
$$
&47\equiv2(mod\ 9),30\equiv3(mod\ 9)\\
加法：&77\equiv47+30\equiv(2+3)(mod\ 9)\equiv5(mod\ 9)\\
减法：&17\equiv47-30\equiv(2-3)(mod\ 9)\equiv8(mod\ 9)\\
乘法：&1410\equiv47\times30\equiv(2\times3)(mod\ 9)\equiv6(mod\ 9)\\
公因数提取：&\frac{30}{3}\equiv\frac{3}{3}(mod\ \frac{9}{3})即10\equiv1(mod\ 3)（3是30,3,9的公因数）\\
3\mid9所以：&47\equiv2(mod\ \frac{9}{3})即47\equiv2(mod\ 3)
$$
例题1：$3^{801}(mod\ 10)=?$
解：
$$
\because&3^2\equiv9mod10,3^3\equiv7mod10,3^4\equiv1mod10,801=4\times200+1\\
\therefore&3^{801}=3^{4\times200+1}=(3^4)^{200}\times3\equiv1\times3mod(10)=3(mod10)\\
\therefore&3^{801}(mod\ 10)=3
$$
例题2：证明一个是进制整数$n=(a_ka_{k-1}\cdots a_0)_{10}$整除3和整出9的充分条件为它的各个位数的和分别被3和9整除：
即证：$n=a_k\cdot10^k+a_{k-1}\cdot10^{k-1}+\cdots++a_1\cdot10+a_0$，则$3\mid n\iff3\mid\sum\limits^k_{i=0}a_i,9\mid n\iff9\mid\sum\limits^k_{i=0}a_i$
解：
$$
\because&10\equiv1(mod\ 3),10\equiv1(mod\ 9)\\
\therefore&n=\sum\limits^k_{i=0}a_i(mod\ 3),n=\sum\limits^k_{i=0}a_i(mod\ 9)\\
\therefore&3\mid n\iff3\mid\sum\limits^k_{i=0}a_i,9\mid n\iff9\mid\sum\limits^k_{i=0}a_i
$$

所以，判断$n=6789$是否可被$3,9$整除，求$\sum\limits^k_{i=0}a_i=6+7+8+9=30$。
因为$3\mid30,9\nmid30$，所以$3\mid6789,9\nmid6789$。

## 2.2 同余类与剩余系

## 2.3 RSA公钥密码体制简介