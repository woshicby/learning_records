# 第六章 数字签名

## 6.1 数字签名的基本概念

### 6.1.1 数字签名基本概念

**数字签名**：类似写在纸上的传统的物理签名，使用公钥加密技术实现，用于鉴别数字信息或者签名者身份的方法。

数字签名必须保证：
①接收者能够核实发送者对文档的签名；
②发送者时候不能否认对文档的签名；
③不能伪造对文档的签名。

签名包括消息和载体两个部分。消息：签名所表示的意义。载体：签名的物理表现形式

|              | 传统签名                                                   | 数字签名                                             |
| ------------ | ---------------------------------------------------------- | ---------------------------------------------------- |
| 载体         | 签名和文件是具有共同的物理载体                             | 签名与文件是电子形式，签名与文件的物理形式和消息分开 |
| 可分割       | 物理上不可分割                                             | 电子载体是可以任意分割                               |
| 可重复使用性 | 签名与文件不可分割，不能重复使用。                         | 数字签名有可能与文件分割，被重复使用。               |
| 可复制性     | 物理上不可复制                                             | 可以任意复制的                                       |
| 安全性       | 不安全                                                     | 计算上安全                                           |
| 可否认性     | 不能否认                                                   | 不能否认                                             |
| 可伪造性     | 能被伪造                                                   | 不能被伪造                                           |
| 可验证性     | 容易被验证                                                 | 容易被自动验证                                       |
| 验证方式     | 通过与存档手迹对照来确定真伪，是主观的、模糊的、容易伪造的 | 使用密码，通过公开算法进行检验，是客观的、精确的     |

传统签名的基本特点：①能与被签的文件在物理上不可分割②签名者不能否认自己的签名③签名能被伪造④容易被验证。

数字签名是传统签名的数字化，基本要求：①能与所签文件“绑定”②签名者不能否认自己的签名③签名不能被伪造④容易被自动验证。

### 6.1.2 数字签名的构成

一个数字签名方案包括如下3个算法：

①密钥生成：产生用户的公私钥。

②签名算法：产生消息的签名。

③验证算法：验收消息的签名是否合法。

### 6.1.3 数字签名安全需求

数字签名方案为了实现安全验证，需要满足如下条件：

①必须相对容易生成该数字签名。

②必须相对容易识别和验证该数字签名。

③伪造该数字签名在计算上不可行，既包括对一个已有的数字签名构造新的信息，也包括对一个信息伪造一个数字签名。

## 6.2 RSA签名算法

### 6.2.1 RSA签名算法的密钥生成

①：选两个保密的大素数p和q，$n=p\times q,\phi(n)=(p-1)(q-1)$

②：选一整数$e,1\lt e\le\phi(n),gcd(\phi(n),e)=1$

③：计算$d,d\cdot e\equiv 1(mod\ \phi(n))$

④：以$\{e,n\}$为公钥，$\{d,n\}$为私钥

### 6.2.2 RSA签名算法的签名

设消息$m\in Z_n$，对其签名为$s\equiv m^d(mod\ n)$，即求得消息m的签名为s。

### 6.2.3 RSA签名算法的验证

接收方收到消息m和签名s后，验证$m\overset{?}{\equiv}s^e(mod\ n)$。若等式成立，则s是消息m的有效签名，反之则是无效签名。

### 6.2.4 RSA签名的正确性

$d\cdot e\equiv1(mod\ \phi(n))\Rightarrow s^e=m^{de}\equiv m^{1+k\phi(n)}\equiv m^1m^(k\phi(n))\equiv m(mod\ n)$

其中k为某个整数。

### 6.2.5 RSA签名算法的缺点

对任意$y\in Z_n$，任何人可计算$x\equiv y^e(mod\ n)$，因此任何人可伪造对随机信息x的签名。

若消息$x_1,x_2$的签名分别为$y_1,y_2$，则知道$x_1,x_2,y_1,y_2$的人可伪造消息$x_1x_2$的签名$y_1y_2$。

在RSA签名方案中，需要签名的消息$x\in Z_n$，所以每次只能对$\lfloor\log_2n\rfloor$位长的信息进行签名。签名速度慢。

解决方法：引入hash函数

### 6.2.6 RSA的安全基础

RSA签名方案的安全性规约于大数分解问题。

## 6.3 EI-Gamal签名算法

1985年。EI-Gamal提出了一个基于离散对数问题的签名方案，后来称为EI-Gamal数字签名方案。

1991年该数字签名方案的变形被美国国家标准局（NIST）确定为数字签名标准（DSS）。

### 6.3.1 EI-Gamal签名算法的密钥生成

①：选取大素数$p,q\in Z^*_p$是一个本原元。p和g公开

②：随机选取整数$x,1\le x\le p-2$，计算$y=g^x(mod\ p)$

③：公钥为y，私钥为x

### 6.3.2 EI-Gamal签名算法的签名

对于消息m，首先随机选取整数$k,1\le k\le p-2$，然后计算$\begin{cases}r=g^k(mod\ p)\\s=(h(m)-xr)k^{-1}(mod\ (p-1))\end{cases}$

则m的签名为$(r,s)$，其中$h()$为hash函数。

### 6.3.3 EI-Gamal签名算法的验证

接收方在收到信息m和签名$(r,s)$后验证$y^rr^s\overset{?}{=}g^{h(m)}(mod\ p)$。

如果等式成立，则$(r,s)$是消息m的有效签名，反之则是无效签名。

### 6.3.4 EI-Gamal签名算法的正确性
$$
\because&s=(h(m)-xr)k^{-1}(mod\ (p-1))\\
\therefore&sk+xr=h(x)(mod\ (p-1))\\
\therefore&g^{h(m)}=g^{(sk+xr)}=g^{sk}g^{xr}=y^rr^s(mod\ p)
$$
### 6.3.5 EI-Gamal签名算法的两个问题

①：用EI-Gamal方案计算一个签名时，使用的随机数k能不能泄漏？

②：若Bob用相同的k值来签名两份不同的信息，Oscar能否攻破这个体制？

## 6.4 DSS签名算法

1991年，数字签名标准（DSS）在EI-Gamal数字签名和Schnorr数字签名的基础上发展而来，被美国国家标准局（NIST）确定为数字签名标准。

### 6.4.1 DSS签名算法的密钥生成

①：设$512\le L\le1024$且L是64的倍数，选取$2^{L-1}\lt p\lt 2^L$的大素数p，其满足存在160比特的素数$q\mid p-1$

②：随机选取整数$h,g$，使得$1\lt h\lt p-1,g=h^{\frac{p-1}{q}}(mod\ p)\gt1$，p和g公开

③：随机选取整数$x,1\le x\le q-1$，计算$y=g^x(mod\ p)$

④：公钥为y，私钥为x

### 6.4.2 DSS签名算法的签名

对于消息m，首先随机选取整数$k,1\le k\le p-2$，然后计算$\begin{cases}r=g^k(mod\ p)(mod\ q)\\s=(h(m)+xr)k^{-1}(mod\ q)\end{cases}$

则m的签名为$(r,s)$，其中$h()$为hash函数SHA。

### 6.4.3 DSS签名算法的验证

接收方在收到信息m和签名$(r,s)$后，计算$\begin{cases}u_1=h(m)s^{-1}(mod\ q)\\u_2=rs^{-1}(mod\ q)\end{cases}$

验证$g^{u_1}y^{u_2}(mod\ p)(mod\ q)\overset{?}{=}r$。

如果等式成立，则$(r,s)$是消息m的有效签名，反之则是无效签名。

### 6.4.4 DSS签名算法的正确性

$$
\because&u_1+xu_2(mod\ q)=(h(m)+xr)s^{-1}(mod\ q)=k\\
\therefore&\begin{aligned}&g^{u_1}y^{u_2}(mod\ p)(mod\ q)\\=&g^{u_1+xu_2}(mod\ p)(mod\ q)\\=&g^k(mod\ p)(mod\ q)\\=&r\end{aligned}
$$



## 6.5 EI-Gamal类签名算法

### 6.5.1 基于离散对数问题的数字签名方案

EI-Gamal签名方案、DSS签名方案、Schnorr签名方案都是基于离散对数困难问题的签名方案。

密钥产生方式的共同点：都使用了离散对数方式来构造公私钥

签名方式类似性：如EI-Gamal数字签名：对于消息m，首先随机选取整数$k,1\le k\le p-2$，然后计算$\begin{cases}r=g^k(mod\ p)\\s=(h(m)-xr)k^{-1}(mod\ (p-1))\end{cases}$

则m的签名为$(r,s)$，其中$h()$为hash函数。若把k和x互换位置，依旧可以产生数字签名，这种类型的加密方式都属于EI-Gamal类签名算法

### 6.5.2 EI-Gamal签名算法的密钥生成

①：p和q是大素数，且$q\mid p-1$

②：随机选取q阶元g，$1\lt g\lt p-1$。$q,p,g$公开

③：随机选取整数$x,1\le x\le q-1$，计算$y=g^x(mod\ p)$

④：公钥为y，私钥为x

### 6.5.3 EI-Gamal签名算法的签名

对于消息m，计算签名如下：

①计算m的Hash值$h(m)$

②随机选取整数$k,1\le k\le q$，然后计算$r=g^k(mod\ p)$，从等式$ak=b+cx(mod\ q)$中计算出s。

其中方程的系数$a,b,c$有多总选择，取集合$\{a,b,c\}=\{r,s,h(m)\}$，则m的签名为$(r,s)$。

### 6.5.4 EI-Gamal签名算法的验证



### 6.5.5 一些基于离散对数问题的签名方案

## 6.6 特殊性质的签名算法

## 6.7 SM2数字签名算法

