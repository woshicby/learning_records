# 第一章 计算机网络和因特网

## 1.1 什么是因特网

因特网（Internet）：世界范围的计算机网络，即互联了遍及全世界的计算设备的网络。

### 1.1.1 具体构成描述

被网络连接的所有设备成为主机（host）/端系统（end system）

端系统=主机，因为它们容纳（即运行）应用程序

主机分为两类：客户（client）和服务器（server）

当前大部分服务器属于大型数据中心（data center）

端系统通过通信链路（communication link）和分组交换机（packet switch）连接在一起

通信链路由不同类型的物理媒体（如同轴电缆、铜线、光缆、无线电频谱）组成

通信链路的传输速率以bit/s来陆良

分组交换机中最显著的类型有路由器（router）和链路层交换机（link-layer switch）

路径（path/route）：一个分组说经历的一系列通信链路和分组交换机成为通过该网络的路径。

因特网服务提供商（Internet Service Provider，ISP）：为端系统提供接入因特网的服务

因特网服务提供商：是一个由多个分组交换机和多段通信链路组成的网络，为端系统/内容提供者/低层IPS提供各种不同类型的网络接入（线缆调制解调器或DSL的住宅宽带接入、高速局域网接入、无线接入、56kbps拨号调制解调器接入）

协议（protocol）：端系统、分组交换机和其他因特网部件都要运行一系列协议，控制因特网中信息的接收和发送。

协议定义了在两个或多个通信实体之间交换的报文格式和次序，以及报文发送和/或接受一条报文或其他事件所采取的动作。

因特网中两个最为重要的协议：TCP（Transmission Control Protocol，传输控制协议）、IP（Internet Protocol，网际协议）

IP：定义了在路由器和端系统之间发送和接收的分组格式

因特网的主要协议统称为TCP/IP

因特网标准（Internet standard）由因特网工程任务组（Internet Engineering Task Force，IETF）研发

请求评论（Request For Comment，RFC）：IETF的标准文档

### 1.1.2 服务描述

分布式应用程序（distributed application）：涉及多台相互交换数据的端系统，的应用程序。（例如：电子邮件、Web上网、即时讯息、社交网络、IP语音（VoIP）、流式视频、分布式游戏、对等（peer-to-peer，P2P）文件共享、因特网电视、远程注册等）

应用程序编程接口（Application Programming Interface，API）：规定了运行在一个端系统上的软件请求因特网基础设置向运行在另一个端系统上的特定目的地软件交付数据的方式。

因特网API：一套发送软件必须遵循的规则集合，因此因特网能够将数据交付目的地。

## 1.2 网络边缘

接入网（access network）：将端系统连接到其边缘路由器（edge router）的物理链路。

边缘路由器（edge router）：端系统到任何其他远程端系统的路径上的第一台路由器

### 1.2.1 接入网：DSL、电缆、FTTH、拨号、卫星、以太网、WIFI、广域无线接入

#### 1.2.1.1 用户数字线DSL

数字用户线（Digital Subscribe Line）：使用电话线（双绞铜线）与位于本地电话公司的本地中心局（CO）中的数字用户线接入复用器（DSLAM）来交换数据，家庭的DSL调制解调器得到数字数据后转换为高频音（模拟信号），通过电话线传输给本地中心局。在DSLAM处转换回数字形式，上下行不对称

DSL的信道：高速下行信道（50kHz-1Mhz）、中速上行信道（4kHz-50kHz）、普通的双向电话信道（0-4kHz）

#### 1.2.1.2 电缆因特网接入

电缆因特网接入（cable Internet access）：利用有线电视公司现有的有线电视基础设施，从有线电视公司获得电缆因特网接入。使用同轴电缆和光纤，所以常被称为混合光纤同轴（Hybrid Fiber Coax，HFC）使用电缆调制解调器（cable modem）和电缆调制解调器端接系统（Cable Modem Termination System，CMTS），上下行不对称

电缆因特网接入的一个重要特征：共享广播媒体（几个用户同时下载一个文件，实际速率低。极少活跃用户则每个用户可以以全部速率接受，信道共享，所以需要分布式堵路协议来协调传输和避免碰撞）

#### 1.2.1.3 光纤到户FTTH

光纤到户（Fiber To The Home，FTTH）:从本地中心局到每户设置一根光纤（实际上每根光纤由许多家庭共享，直到相对接近这些家庭的位置才分成每户一根光纤）

两种竞争性的光纤分布体系结构：主动光纤网络（Active Optical Network，AON）、被动光纤网络（Passive Optical Network，PON）

PON：每个家庭有一个光纤网络端接器（Optical Network Terminator，ONT），它由专门的光纤连接到邻近的分配器（splitter），分配器吧一些家庭集结到一根共享的光纤，该光纤连接到本地中心局的光纤线路端接器（Optical Line Terminator，OLT）。该OLT提供光信号和电信号的转换，经过本地电话公司路由器与因特网相连。家庭中通过家庭路由器与ONT相连，通过家庭路由器接入因特网。

PON中，所有从OLT发送到分配器的分组在分配器处复制

### 1.2.2 物理媒体：双绞铜线、同轴电缆、光纤、陆地无线电信道、卫星无线电信道

物理媒体（physical medium）划分为两类导引型媒体（guided media）和非导引型媒体（unguided media）

导引型媒体：电波沿着固体媒体前行

非导引型媒体：电波在空气或外层空间中传播

物理链路的实际成本和其他网络成本相比通常是相当小的。特别是安装物理链路的劳动力成本能够比材料成本高几个数量级。

无屏蔽双绞线（Unshielded Twisted Pair，UTP ）常用于建筑物内的计算机网络中，即用于局域网（LAN）中。

同轴电缆能够被用作导引型共享媒体（shard medium）

光纤：常用于长途引导型传输媒体，因特网的猪肝，光设备成本高。光载波（Optical Carrier，OC）标准的链路数率范围从51.8Mbps到39.8Gbps，包括OC-1/3/12/24/48/96/192/768

陆地无线电信道：很短距离（1m-2m）、局域（数十到上百米）、广域（数万米）极打地依赖于传播环境和传输信号的距离。环境上取决于路径损耗和遮挡衰落（信号跨距离传播和绕过/通过阻碍物体时信号降低强度）、多径衰弱（由于抗扰对象的信号反射）以及干扰（由于其他无线电信道或电磁信号）

卫星无线电信道：常使用两类卫星：同步卫星（geostationary satellite）和近地轨道（Low-Earth Orbiting，LEO）卫星。

同步卫星：永久地停留在地球上方的相同点上，位于地球表面上方36000km的轨道上，信号传播时延280ms

近地轨道卫星：非常靠近地球，不是永久地停留在地球上方的一个点。提供一个区域的连续覆盖，需要在轨道上放置许多卫星。

## 1.3 网络核心

网络核心：由互联因特网端系统的分组交换机和链路构成的网状网络

### 1.3.1 分组交换

报文（message）：包含协议设计者需要的任何功能，可以执行一种控制功能，也可以包含数据。

分组（packet）：发送端系统将要长报文划分为较小的数据块，并为每段加上首部字节所形成的信息包。

分组以等于该链路最大传输速率的速度传输通过通信链路，所以发送一个L比特的分组，传输速率为R比特/秒，则传输时间为L/R秒。

存储转发传输（store-and-forward transmission）机制：交换机能够开始向输出链路传输该分组的第一个比特之前，必须接收到整个分组。

通过N条串接的，速率为R的链路组成的路径（中间有N-1台路由器），则发送1个分组的端到端的存储转发时延为d=NL/R

排队时延（queue delay）：如果到达的分组需要传输到某条链路，但该链路正忙于传输其他分数，则该分组必须等待，产生排队时延

分组丢失（丢包）（packet lost）：因为缓存空间的大小是有限的，一个到达的分组可能发现该缓存已被其他等待传输的分组完全充满了，则到达的分组或已经排队的分组之一将被丢弃，产生丢包。

转发表（forwarding table）：用于将目的地之（或目的地址的一部分）映射成为输出链路。

### 1.3.2 电路交换

电路（circuit）：发送信息之前，该网络必须在发送方和接收方之间建立一条连接，在该路径上的交换机都将为该连接维护连接状态，预留恒定的传输速率。

端到端连接（end-to-end connection）：两台主机之间的专用连接。

频分复用（Frequency-Division Multiplexing，FDM）：链路的频谱由跨越链路创建的所有连接所共享，连接期间为每条连接专用一个频段。

带宽（bandwidth）：频段的宽度

时分复用（Time-Division Multiplexing，TDM）：时间被划分为固定区间的帧，每帧又划分为固定数量的时隙，当网络跨越一条链路创建一条连接是，网络在每个帧中为该连接指定一个时隙。

### 分组交换与电路交换的对比

| 交换方式 | 优点                                                         | 缺点                                                         |
| -------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 分组交换 | ①比电路交换更好的带宽共享②比电路交换更简单、更有效，实现成本更低 | ①分组交换不适合实时服务，因为端到端时延是可变和不可预测的    |
| 电路交换 |                                                              | ①在静默期（silent period）专用电路空闲而效率较低。②创建端到端电路和预留端到端带宽是复杂的，需要复杂的信令软件以协调端到端路径的交换机的操作。 |

### 1.3.3 网络的网络

网络结构Ⅰ：用单一的全球承载ISP互联所有ISP，接入ISP被认为是客户（customer），全球承载ISP被认为是提供商（provider）

网络结构Ⅱ：由数十万个接入ISP和多个全球承载ISP组成（全球承载ISP之间必须互联）

网络结构Ⅲ：在任何区域可能有一个区域ISP（reginal ISP），区域中接入ISP与之相连接，每个区域ISP与第一层ISP（tier-1 ISP）连接，第一层ISP相当于全球承载ISP

网络结构Ⅳ：在网络结构Ⅲ中增加存在点（Point of Presence，PoP）、多宿（multi-home）、对等（peer）和因特网交换点（Internet exchange point，IXP）

存在点PoP：提供商网络中的一台或多台路由器（在相同位置）群组，对于要与提供商PoP连接的客户网络，它能从第三方通信提供商租用高速链路直接将它的路由器之一连接到位于该PoP的一台路由器。

多宿：与两个或更多提供商ISP连接

对等：位于相同等级结构层次的邻近一对ISP能够直接将它们的网络连在一起，从而节约费用

因特网交换点IXP：多个ISP能够在这里共同对等

网络结构Ⅴ：在网络结构Ⅳ的顶部增加内容提供商网络（content provider network），内容提供商通过与较低层ISP对等和在IXP对等绕过因特网的较高层

## 1.4 分组交换网中的时延、丢包和吞吐量

分组的结点总时延（total nodal delay）包括结点处理时延（nodal processing delay）、排队时延（queue delay）、传输时延（transmission delay）、传播时延（propagation delay）

处理时延：主要是检查分组首部和决定将该分组导向何处说需要的时间，也能包括其他因素，如检查比特级别的差错所需要的时间（通常为微秒或更低的数量级）

排队时延：分组在链路的队列上等待传输的时延（可以是毫秒到微秒数量级）

传输时延：将分组的比特推向链路所需要的时间（L/R）（通常在毫秒到微妙量级）

传播时延：比特从链路的起点到链路的重点传播所需要的时间，传播速率取决于该链路的物理媒体，等于或略小于光速（广域网中为毫秒量级）

最大吞吐量：一台路由器能够转发分组的最大速率

流量强度（traffic intensity）：假设所有分组都是L比特，分组到达队列的平均速率a（单位为分组/秒（pkt/s）），传输速率为R，则流量强度=La/R

流量强度大于1，则队列趋向于无界增加，排队时延趋向无穷大。

随着流量强度接近于1，平均排队时延将迅速增加，分组损失的份额也会增加

端到端时延=结点总时延×链路结点数N（假设源主机和目的主机中间有N-1台路由器）

媒体分组化时延：出现在经IP语音（VoIP）应用中

瞬时吞吐量（instantaneous throughput）：是主机接受到文件的速率。

平均吞吐量（average throughput）：传输文件由F比特组成，接受它用去T秒，平均吞吐量为F/Tbps

瓶颈链路（bottleneck link）：一个路径中最慢的一段链路，一个路径中的吞吐量=瓶颈链路的传输速率

## 1.5 协议层次及其服务模型

#### 1.5.1.1 协议分层

协议分层（layer）：每一层向它的上一层提供服务，同时也使用下一层的服务。具有结构化和概念化的有点

协议栈（protocol stack）：各层的所有协议

因特网的协议栈：物理层、链路层、网络层、传输层、应用层

应用层：网络应用程序及他们的应用层协议存留的地方，包括HTTP（提供Web文档的请求和传送）、SMTP（提供电子邮件报文的传送）、FTP（提供两个端系统之间的文件传送）、DNS（提供域名到IP地址的转换）等协议。

报文（message）：位于应用层的信息分组

传输层：在应用程序端点之间传送应用层报文，有TCP（提供面对连接的服务，包括报文向目的地的确保传递和流量控制、拥塞控制）和UDP（提供无连接服务，没有可靠性、流量控制和拥塞控制）

报文段（segment）：位于传输层的信息分组

网络层：负责将数据报（datagram）的网络层分组从一台主机移动到另一台主机，包括IP协议（定义了数据报中的各个字段以及端系统和路由器如何作用于这些字段）、路由选择协议（使得数据报根据路由从源传输到目的地）

数据报（datagram）：位于网络层的信息分组

链路层：将整个帧从一个网络元素移动到邻近的网络元素，基于链路提供可靠传递，有DOCSIS（常用于以太网、WiFi、电缆接入网）、PPP等协议

帧（frame）：位于链路层的信息分组

物理层：将该帧中的一个一个比特从一个结点移动到下一个结点，有关于各种传输媒体的物理层协议。

#### 1.5.1.2 OSI模型

OSI模型：包含7层：应用层、表示层、会话层、运输层、网络层、数据链路层、物理层

表示层：使通信的应用程序能够解释交换数据的含义（包括数据压缩和加密、数据描述）

会话层：数据交换定界和同步功能（包括建立检查点和恢复方案的方法）

为何缺少了两层：因为如果一个应用程序需要这些服务之一，这将由应用程序开发者处理。如果需要，就由应用程序开发者在应用程序中构建该功能

### 1.5.2 封装

封装（encapsulation）的过程：

应用层报文（application-layer message）+传输层首部信息（也许包含：允许接收端传输层向上向适当的应用程序交付报文的信息（如差错检测位信息））=传输层报文段（transport-layer segment）

传输层报文段（transport-layer segment）+网络层首部信息（原和目的端系统地址）=网络层数据报（network-layer datagram）

网络层数据报（network-layer datagram）+链路层首部信息=链路层帧（link-layer frame）

所以每个分组=首部字段+有效载荷字段（payload field）

## 1.6 面对攻击的网络

### 1.6.1 经因特网把有害程序放入目标计算机中

僵尸网络（botnet）：由数以千计的受害主机组成的网络

病毒（virus）：一种需要某种形式的用户交互来感染用户设备的恶意软件（malware）

蠕虫（worn）：一种无需任何明显用户交互就能进入设备的恶意软件

### 1.6.2 攻击服务器和网络基础设施

拒绝服务供给（Denial-of-Service（DoS）attack）：使得网络、主机或其他基础设施部分不能由合法用户所使用。

大多数DoS攻击属于以下三种：弱点攻击（向一台目标主机上运行的易受攻击的应用程序或操作系统发送制作精细的报文，导致服务器停止运行或崩溃）、带宽洪泛（向目标主机发送大量的分组，使得目标主机的接入链路拥塞，合法的分组无法到达服务器）、连接洪泛（在目标主机中创建大量的半开或全开TCP连接，使得主机无法接受合法的连接）

分布式DoS（Distributed DoS，DDoS）：攻击者控制多个源并让每个源向目标猛烈发送流量，所有受控源的聚合流量速率需要大约R的能力

### 1.6.3 嗅探分组

分组嗅探器（packet sniffer）：记录每个流经的分组副本的被动接收机

防御方法基于密码学

### 1.6.4 伪装成信任的人

IP哄骗（IP spoofing）：将具有虚假源地址的分组注入因特网的能力

端点识别：使我们能够确信一个报文源自我们认为它应当来自的地方的机制。

## 1.7 计算机网络和因特网的历史

20世纪60年代早期：计算机网络的开端

ARPAnet：第一个分组交换计算机网络

1972：ARPAnet首次公众演示

1972：第一个电子邮件程序

20世纪70年代早期和中期：ARPAnet以外的分组交换网络问世：ALOHAnet

20世纪70年代末：TCP、UDP、IP在概念上已经完成

ALOHA协议：第一个多路访问协议

20世纪70年代末：大约200台主机与ARPAnet相连

20世纪80年代：连接到公共因特网上的主机数量达100000台

1983.1.1：TCP/IP替代了NCP协议

20世纪80年代后期：TCP实现基于主机的拥塞控制，DNS出现

20世纪90年代：万维网（World Wide Web）应用程序的出现

# 课后习题答案


https://blog.51cto.com/u_14797091/2758914
